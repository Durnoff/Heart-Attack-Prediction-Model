# Heart Attack Prediction Model

![](https://i.pinimg.com/originals/d6/5f/20/d65f20340ceba18170c2b66154243e10.jpg)

## Введение

Заболеваемость и смертность от сердечно-сосудистых заболеваний (ССЗ) продолжает расти во всем мире на протяжении последних нескольких десятилетий. Машинное обучение дает возможность повысить точность прогнозирования рисков сердечно-сосудистых заболеваний.

## Описание проекта

В этом проекте мы изучим статью о применении моделей машинного обучения для предсказания ССЗ, а также обучим собственные модели и провалидируем их на тестовой выборке.

## 1. Цель исследования

Построение моделей машинного обучения для прогнозирования наличия у пациента ССЗ на основе предоставленных данных.

## 2. Детализация задач
```
1. Анализ и предобработка данных.
2. Обучение моделей (Logistic Regression, Randomforest, Neural Network) и сравнение результатов. Построение графиков зависимостей, выбросов.
3. Проверка состоятельности и валидация модели на тестовых данных.
4. Подготовка скрипта для инференса.
```
## 3. Технологии

В ходе работы мы использовали следующие библиотеки и технологии:
```
1. Pandas для работы с данными.
2. NumPy для операций с массивами.
3. Matplotlib и Seaborn для визуализации данных.
4. Scikit-learn для предобработки данных, построения моделей и подбора гиперпараметров.
5. SHAP для анализа важности признаков.
6. joblib для сохранения и загрузки модели.
```

## 4. Основные пункты работы

## Предобработка данных:
```
1. Удаление строк с пропусками, чтобы избежать ошибок в обучении моделей.
2. Преобразование категориальных признаков с использованием фиктивных переменных (one-hot encoding).
3. Масштабирование числовых признаков с использованием стандартизации, что улучшает сходимость некоторых моделей.
```
## Анализ данных:
```
1. Построение корреляционной матрицы для выявления взаимосвязей между признаками. Она показала, какие признаки имеют сильную положительную или отрицательную корреляцию между собой.
2. Построение диаграммы рассеяния для визуализации распределения данных и возможных закономерностей между различными признаками.
3. Построение графиков выбросов. Они помогли выявить выбросы в данных и оценить распределение значений признаков.
```
## Построение и обучение моделей:
```
1. Мы обучили три модели: логистическую регрессию, случайный лес, нейронную сеть.
2. Для каждой модели был выполнен подбор гиперпараметров с помощью GridSearchCV, что позволило улучшить точность предсказаний.
3. По результатам валидации мы выбрали наилучшую модель с точки зрения точности.
```
## Оценка и визуализация результатов:
```
1. Для каждой модели были выведены наилучшие гиперпараметры, что позволило детально оценить, какие параметры влияют на качество предсказаний.
2. Графики обучения были построены для всех моделей, что помогло понять динамику изменения ошибки на этапе обучения и избежать переобучения.
3. Важность признаков была визуализирована для каждой модели. Для моделей, где невозможно было получить важность напрямую, использовалась библиотека SHAP, которая показала, какие признаки сильнее всего влияют на предсказания.
```
## Результаты анализа:
```
1. По результатам анализа важности признаков, с использованием случайного леса и SHAP, можно сделать выводы о том, какие признаки имеют наибольшее влияние на прогнозирование заболевания. Некоторые признаки, такие как физиологические показатели (например, уровень давления, индекс массы тела и др.), имели высокий уровень значимости. Признаки, связанные с полом, возрастом и определенными медицинскими обследованиями, также оказались важными.
2. Наиболее значимые признаки могут варьироваться в зависимости от модели, однако совпадения среди ключевых признаков могут указывать на их высокую значимость.
3. Анализ корреляционной матрицы показал, что некоторые признаки имеют умеренную корреляцию друг с другом, что может указывать на наличие латентных зависимостей. Например, уровень физической активности мог коррелировать с индексом массы тела и состоянием сердечно-сосудистой системы.
4. Подбор гиперпараметров показал, что точность моделей значительно зависит от их настройки. Например:
5. В логистической регрессии ключевыми параметрами были значение регуляризации и тип оптимизатора.
6. В случайном лесе наибольшее влияние оказали количество деревьев и глубина дерева.
7. В нейронной сети важную роль играла структура слоев и скорость обучения.
```
## 5. Заключение
```
В результате работы мы построили несколько моделей машинного обучения, каждая из которых прошла подбор гиперпараметров. На основе валидации была выбрана лучшая модель, которая показала наилучшую точность при прогнозировании заболевания. Мы также выявили наиболее значимые признаки, влияющие на прогноз, что может помочь в дальнейшем медицинском анализе и принятии решений.
```
